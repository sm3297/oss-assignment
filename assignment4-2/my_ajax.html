<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>상품 관리</title>
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.min.js" ></script>
    <style>
        
        body {
            margin: 20px;
        }
        input {
            margin: 5px;
            padding: 2px;
            width: 180px;
        }
        button {
            margin: 5px;
            padding: 10px 15px;
        }

        .response {
            display: none;
            font-size: 18px;
        }

        @media (max-width: 768px) {
            .response {
                display: block;
                font-size: 18px;
                font-weight: bold;
            }
            .table {
                display: none;
            }
        }

       .kind th , .kind td {
            border: 1px solid black;
        }
    </style>

</head>
<body>
    <div class="container mt-5">
    <h1>상품 관리</h1>
        고유번호(id)
        <input type="text" id="input_id" placeholder="1"/> 
    <br /> <br />

    <!-- Button trigger modal -->
    <button class="btn btn-outline-success" data-bs-toggle="modal" data-bs-target="#exampleModal1">추가하기(C)</button>

    <!-- Modal -->
    <div class="modal fade" id="exampleModal1" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">

                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">추가하기(C)</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>

                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label"> 품목(type)</label>
                        <input type="text" id="input_type" placeholder="electronics"/> <br/>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">품명(name)</label>
                        <input type="text" id="input_name" placeholder="smartphone"/> <br/>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">가격(price)</label>
                        <input type="number" id="input_price" placeholder="900000"/>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">재고 (stock)</label>
                        <input type="number" id="input_stock" placeholder="10"/> <br/>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button id="btn_add" type="button" class="btn btn-primary" data-bs-dismiss="modal">Save changes</button>
                </div>

            </div>
        </div>
    </div>


    <button id="btn_detail" class="btn btn-outline-success">조회하기(R)</button>

    <!-- Button trigger modal -->
    <button class="btn btn-outline-success" data-bs-toggle="modal" data-bs-target="#exampleModal2">수정하기(U)</button>

    <!-- Modal -->
    <div class="modal fade" id="exampleModal2" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">

                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">수정하기(U)</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>

                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label"> 고유번호(id) </label>
                        <input type="text" id="u_id" placeholder="1"/> 
                    </div>

                    <div class="mb-3">
                        <label class="form-label"> 품목(type)</label>
                        <input type="text" id="u_type" placeholder="electronics"/> <br/>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">품명(name)</label>
                        <input type="text" id="u_name" placeholder="smartphone"/> <br/>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">가격(price)</label>
                        <input type="number" id="u_price" placeholder="900000"/>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">재고 (stock)</label>
                        <input type="number" id="u_stock" placeholder="10"/> <br/>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button id="btn_update" type="button" class="btn btn-primary" data-bs-dismiss="modal">Save changes</button>
                </div>

            </div>
        </div>
    </div>


    <button id="btn_delete" class="btn btn-outline-danger">삭제하기(D)</button>
    <button id="btn_list" class="btn btn-secondary">목록 보기</button>
    <br /> <br />

    <span style="color:red">* </span> 추가시 모든 내용을 입력하지 않아도 됩니다.
    <br /> 
    <span style="color:red">* </span> 조회 또는 삭제시 목록보기를 클릭후 참고해서 해당하는 품명 id만 입력해주세요.
    <br /> 
    <span style="color:red">* </span> 수정시 id를 반드시 기입후 수정할 내용을 입력해주세요.
    <br />

    <hr />

    <h2>상품 목록</h2>
    <div id="div_list"></div>
    </div>

    <script>
    
        $(function(){

            $("#btn_add").click(function(){

                const xhr = new XMLHttpRequest();
                xhr.open("POST","https://6917f5d221a96359486e5d31.mockapi.io/products");
                xhr.setRequestHeader("content-type","application/json");
                let data = {type: $("#input_type").val(), name: $("#input_name").val(), price: $("#input_price").val(), stock: $("#input_stock").val() };
                xhr.send(JSON.stringify(data));
                xhr.onload = () => {
                    if (xhr.status === 200) {
                        let res = JSON.parse(xhr.response);
                        alert(JSON.stringify(res));
                    } else {
                        console.log(xhr.status, xhr.statusText);
                    }
                }
            });
       

            $("#btn_detail").click(function(){
                alert("조회 하시겠습니까?");

                const xhr = new XMLHttpRequest();
                xhr.open("GET","https://6917f5d221a96359486e5d31.mockapi.io/products/" + $("#input_id").val());
                xhr.setRequestHeader("content-type","application/json");
                xhr.send();
                xhr.onload = () => {
                    if (xhr.status === 200) {
                        let res = JSON.parse(xhr.response);
                        alert(JSON.stringify(res));
                    } else {
                        console.log(xhr.status, xhr.statusText);
                    }
                }
            });

            $("#btn_update").click(function(){
  
                const xhr = new XMLHttpRequest();
                xhr.open("PUT","https://6917f5d221a96359486e5d31.mockapi.io/products/" + $("#u_id").val());
                xhr.setRequestHeader("content-type","application/json");
                let data = { id: $("#u_id").val(),type: $("#u_type").val(), name: $("#u_name").val(), price: $("#u_price").val(), stock: $("#u_stock").val() };
                xhr.send(JSON.stringify(data));
                xhr.onload = () => {
                    if (xhr.status === 200) {
                        let res = JSON.parse(xhr.response);
                        alert(JSON.stringify(res));
                    } else {
                        console.log(xhr.status, xhr.statusText);
                    }
                }
            });

            $("#btn_delete").click(function(){
                let result_confirm = confirm("삭제 하시겠습니까?");

                if(result_confirm === false){
                    alert("취소되었습니다.");
                    return;
                }

                const xhr = new XMLHttpRequest();
                xhr.open("DELETE","https://6917f5d221a96359486e5d31.mockapi.io/products/" + $("#input_id").val());
                xhr.setRequestHeader("content-type","application/json");
                xhr.send();
                xhr.onload = () => {
                    if (xhr.status === 200) {
                        let res = JSON.parse(xhr.response);
                        alert(JSON.stringify(res));
                    } else {
                        console.log(xhr.status, xhr.statusText);
                    }
                }
            });

            $("#btn_list").click(function(){
                const xhr = new XMLHttpRequest();
                xhr.open("GET","https://6917f5d221a96359486e5d31.mockapi.io/products");
                xhr.setRequestHeader("content-type","application/json");
                xhr.send();
                xhr.onload = () => {
                    if (xhr.status === 200) {
                        let res = JSON.parse(xhr.response);
                        //alert(JSON.stringify(res));
                        $("#div_list").html("");
                        res.forEach(function(each){
                            $("#div_list").append(`<div>${each.id} : ${each.name} | 품목 : ${each.type} | 가격 : ${each.price}원 | 재고 (${each.stock})</div>`);
                        });
                    } else {
                        console.log(xhr.status, xhr.statusText);
                    }
                }
            });

        });
    </script>
</body>
</html>
