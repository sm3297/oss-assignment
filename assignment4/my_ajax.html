<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>상품 관리</title>
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        
        body {
            margin: 20px;
        }
        input {
            margin: 5px;
            padding: 2px;
            width: 180px;
        }
        button {
            margin: 5px;
            padding: 10px 15px;
        }

        .response {
            display: none;
            font-size: 18px;
        }

        @media (max-width: 768px) {
            .response {
                display: block;
                font-size: 18px;
                font-weight: bold;
            }
            .table {
                display: none;
            }
        }

       .id th , .id td {
            border: 1px solid black;
        }
    </style>

</head>
<body>
    <div class="container mt-5">
    <h1>상품 관리</h1>

    <table class="table table-hover align-middle text-center" style="width:100%;">
        <tr>
            <th>고유번호(id)</th>
            <th>품목(type)</th>
            <th>품명(name)</th>
            <th>가격(price)</th>
            <th>재고(stock)</th>
        <tr>
        <tr>
            <td>
                <input type="text" id="input_id" placeholder="1PE11"/> 
            </td>
            <td>
                <input type="text" id="input_type" placeholder="electronics"/> 
            </td>
            <td>
                <input type="text" id="input_name" placeholder="smartphone"/>
            </td>
            <td>
                <input type="number" id="input_price" placeholder="900000"/>
            <td>
                <input type="number" id="input_stock" placeholder="10"/>
            </td>
        </tr>
    </table>

    <div class="response" style="margin-top:10px;">
        고유번호(id) : <input type="text" id="input_id" placeholder="1PE11"/> <br/>
        품목(type) : <input type="text" id="input_type" placeholder="electronics"/> <br/>
        품명(name) : <input type="text" id="input_name" placeholder="smartphone"/> <br/>
        가격(price) : <input type="number" id="input_price" placeholder="900000"/> <br/>
        재고 (stock) : <input type="number" id="input_stock" placeholder="10"/> <br/>
    </div>

    <br />
    
    <table class="id" style="width:30%; text-align:center" >
        <tr>
            <th>표현</th>
            <th>품목</th>
        </tr>
        <tr>
            <th>P</th>
            <th>Products</th>
        </tr>
        <tr>
            <td>E</td>
            <td>Electronics</td>
        </tr>
        <tr>
            <td>F</td>
            <td>Furniture</td>
        </tr>
        <tr>
            <td>A</td>
            <td>Appliance</td>
        </tr>
        <tr>
            <td>C</td>
            <td>Clothing</td>
        </tr>
        <tr>
            <td>T</td>
            <td>Toy</td>
        </tr>
        <tr>
            <td>B</td>
            <td>Book</td>
        </tr>
    </table>

    <br />

    <button id="btn_add" class="btn btn-outline-success">입력하기(C)</button>
    <button id="btn_detail" class="btn btn-primary">조회하기(R)</button>
    <button id="btn_update" class="btn btn-primary">수정하기(U)</button>
    <button id="btn_delete" class="btn btn-outline-danger">삭제하기(D)</button>
    <button id="btn_list" class="btn btn-secondary">목록 보기</button>
    <hr />

    <h2>상품 목록</h2>
    <div id="div_list"></div>
    </div>
    <script>
        
        $(function(){

            $("#btn_add").click(function(){
                alert("add products?");

                const xhr = new XMLHttpRequest();
                xhr.open("POST","http://localhost:3000/products");
                xhr.setRequestHeader("content-type","application/json");
                let data = { id: $("#input_id").val(), type: $("#input_type").val(), name: $("#input_name").val(), price: $("#input_price").val(), stock: $("#input_stock").val() };
                xhr.send(JSON.stringify(data));
                xhr.onload = () => {
                    if (xhr.status === 200) {
                        let res = JSON.parse(xhr.response);
                        alert(JSON.stringify(res));
                    } else {
                        console.log(xhr.status, xhr.statusText);
                    }
                }
            });


            $("#btn_detail").click(function(){
                alert("detail product?");

                const xhr = new XMLHttpRequest();
                xhr.open("GET","http://localhost:3000/products/" + $("#input_id").val());
                xhr.setRequestHeader("content-type","application/json");
                xhr.send();
                xhr.onload = () => {
                    if (xhr.status === 200) {
                        let res = JSON.parse(xhr.response);
                        alert(JSON.stringify(res));
                    } else {
                        console.log(xhr.status, xhr.statusText);
                    }
                }
            });

            $("#btn_update").click(function(){
                alert("update products?");

                const xhr = new XMLHttpRequest();
                xhr.open("PUT","http://localhost:3000/products/" + $("#input_id").val());
                xhr.setRequestHeader("content-type","application/json");
                let data = { id: $("#input_id").val(),type: $("#input_type").val(), name: $("#input_name").val(), price: $("#input_price").val(), stock: $("#input_stock").val() };
                xhr.send(JSON.stringify(data));
                xhr.onload = () => {
                    if (xhr.status === 200) {
                        let res = JSON.parse(xhr.response);
                        alert(JSON.stringify(res));
                    } else {
                        console.log(xhr.status, xhr.statusText);
                    }
                }
            });

            $("#btn_delete").click(function(){
                alert("delete products?");

                const xhr = new XMLHttpRequest();
                xhr.open("DELETE","http://localhost:3000/products/" + $("#input_id").val());
                xhr.setRequestHeader("content-type","application/json");
                xhr.send();
                xhr.onload = () => {
                    if (xhr.status === 200) {
                        let res = JSON.parse(xhr.response);
                        alert(JSON.stringify(res));
                    } else {
                        console.log(xhr.status, xhr.statusText);
                    }
                }
            });

            $("#btn_list").click(function(){
                const xhr = new XMLHttpRequest();
                xhr.open("GET","http://localhost:3000/products");
                xhr.setRequestHeader("content-type","application/json");
                xhr.send();
                xhr.onload = () => {
                    if (xhr.status === 200) {
                        let res = JSON.parse(xhr.response);
                        //alert(JSON.stringify(res));
                        $("#div_list").html("");
                        res.forEach(function(each){
                            $("#div_list").append(`<div>${each.id} : ${each.name} | 품목 : ${each.type} | 가격 : ${each.price}원 | 재고 (${each.stock})</div>`);
                        });
                    } else {
                        console.log(xhr.status, xhr.statusText);
                    }
                }
            });

        });
    </script>
</body>
</html>
